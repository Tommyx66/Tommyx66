name: Daily System Update

on:
  schedule:
    - cron: '0 12 * * *' # Se ejecuta a las 12:00 UTC
  workflow_dispatch: # Permite ejecutarlo manualmente desde la pestaña Actions

permissions:
  contents: write # ¡Vital! Da permiso al bot para editar tu repo

jobs:
  update-readme:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v3

      - name: Update Date in README
        run: |
          # 1. Obtenemos la fecha
          current_date=$(date -u "+%Y-%m-%d %H:%M UTC")
          
          # 2. Guardamos la fecha en variables de entorno para usarla después
          echo "DATE_VAL=$current_date" >> $GITHUB_ENV

          # 3. EL FIX: Buscamos "Last Update:" (sin 'System')
          # Reemplaza desde "Last Update:" hasta el final de la etiqueta </small>
          sed -i "s/Last Update: .*<\/small>/Last Update: $current_date<\/small>/g" README.md

      - name: Commit and Push
        run: |
          git config --global user.name "Tommyx66-Bot"
          git config --global user.email "tommzx66@gmail.com"
          
          git add README.md
          
          # Si no hay cambios, no falla. Usamos la variable de entorno aquí.
          git commit -m "System Update: ${{ env.DATE_VAL }}" || exit 0
          
          git push
